<div class="content-wrapper">
  <div class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1 class="m-0 text-dark">Doanh thu</h1>
        </div><!-- /.col -->

      </div><!-- /.row -->
    </div><!-- /.container-fluid -->
  </div>
  <div class="container-fluid">
    <div class="content-body">
      <div class="row card">

        <div class="row">
          <div class="col-12 col-sm-6 col-md-3">
            <div class="info-box" (click)="navigateTo('/admin/order')">
              <span class="info-box-icon bg-warning elevation-1"><i class="fas fa-shopping-cart"></i></span>

              <div class="info-box-content" >
                <span class="info-box-text"><h4>Tổng đơn hàng thành công</h4></span>
                <span class="info-box-number">
                  {{turnOver?.billCount}} / {{turnOverAll?.billCount}}
                  <small>đơn hàng</small>
                  <p class="pt-2">
                    <span *ngIf="turnOver?.billCount > turnOverLastMonth?.billCount"><i class="fas fa-arrow-up text-success"> </i>
                      <span class="text-success"> {{turnOver?.billCount - turnOverLastMonth?.billCount}} đơn hàng
                        ({{((turnOver?.billCount / turnOverLastMonth?.billCount) *100).toFixed()}}%)
                      </span>
                    </span>
                    <span *ngIf="turnOver?.billCount < turnOverLastMonth?.billCount"><i class="fas fa-arrow-down text-danger"></i>
                      <span class="text-danger"> {{turnOverLastMonth?.billCount - turnOver?.billCount}} đơn hàng
                        ({{((turnOver?.billCount / turnOverLastMonth?.billCount) *100).toFixed()}}%)
                      </span>
                    </span>
                  </p>
                </span>
              </div>
              <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
          </div>
          <!-- /.col -->
          <div class="col-12 col-sm-6 col-md-3">
            <div class="info-box mb-3" (click)="navigateTo('/admin/import-product')">
              <span class="info-box-icon bg-danger elevation-1"><i class="fas fa-money-bill"></i></span>

              <div class="info-box-content">
                <span class="info-box-text"><h4>Tổng nhập tháng</h4></span>
                <span class="info-box-number">{{turnOver?.importPrice.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                  <p class="pt-2">
                    <span *ngIf="turnOver?.importPrice > turnOverLastMonth?.importPrice"><i class="fas fa-arrow-up text-success"> </i>
                      <span class="text-success"> {{(turnOver?.importPrice - turnOverLastMonth?.importPrice).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                        ({{((turnOver?.importPrice / turnOverLastMonth?.importPrice) *100).toFixed()}}%)
                      </span>
                    </span>
                    <span *ngIf="turnOver?.importPrice < turnOverLastMonth?.importPrice"><i class="fas fa-arrow-down text-danger"></i>
                      <span class="text-danger"> {{(turnOverLastMonth?.importPrice - turnOver?.importPrice).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                        ({{((turnOver?.importPrice / turnOverLastMonth?.importPrice) *100).toFixed()}}%)
                      </span>
                    </span>
                  </p>
                </span>
              </div>
              <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
          </div>
          <!-- /.col -->

          <!-- fix for small devices only -->

          <div class="col-12 col-sm-6 col-md-3">
            <div class="info-box mb-3">
              <span class="info-box-icon bg-success elevation-1"><i class="fas fa-money-bill"></i></span>

              <div class="info-box-content">
                <span class="info-box-text"><h4>Tổng tiền hàng</h4></span>
                <span class="info-box-number">
                  {{turnOver?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                  (<small *ngIf="turnOver?.importPrice > 0">{{((turnOver?.turnover / turnOver?.importPrice) *100).toFixed()}}%</small>
                  <small *ngIf="turnOver?.importPrice == 0">100%</small>)
                  <p class="pt-2">
                    <span *ngIf="turnOver?.turnover > turnOverLastMonth?.turnover"><i class="fas fa-arrow-up text-success"> </i>
                      <span class="text-success"> {{(turnOver?.turnover - turnOverLastMonth?.turnover).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                        ({{((turnOver?.turnover / turnOverLastMonth?.turnover) *100).toFixed()}}%)
                      </span>
                    </span>
                    <span *ngIf="turnOver?.turnover < turnOverLastMonth?.turnover"><i class="fas fa-arrow-down text-danger"></i>
                      <span class="text-danger"> {{(turnOverLastMonth?.turnover - turnOver?.turnover).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                        ({{((turnOver?.turnover / turnOverLastMonth?.turnover) *100).toFixed()}}%)
                      </span>
                    </span>
                  </p>
                </span>
              </div>
              <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
          </div>

          <!-- /.col -->
          <div class="col-12 col-sm-6 col-md-3">
            <div class="info-box mb-3">
              <span class="info-box-icon bg-purple elevation-1"><i class="fas fa-money-bill"></i></span>

              <div class="info-box-content">
                <span class="info-box-text"><h4>Tổng tiền hàng dự kiến</h4></span>
                <span class="info-box-number">
                  {{turnOverExpected?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}

                  <p style="min-height: 28px;"></p>
                </span>
              </div>
              <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
          </div>
          <!-- /.col -->
        </div>
        <div class="row px-2">
          <div class="col-12 col-sm-6 col-md-3">
            <div class="card card-info">
              <div class="card-header">
                <h3 class="card-title">Thao tác</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                  </button>

                </div>
              </div>
              <div class="card-body">
                <div class="">
                  <button class="btn btn-info" (click)="onPrint()">In báo cáo doanh thu tháng này</button> <br>
                  <label class="p-2" for="month">Chọn tháng</label>
                  <select (change)="getTurnOverByMonth(valueMonth)" class="col-12 form-control" name="" [(ngModel)]="valueMonth" id="month">
                    <option value="1">Tháng 1</option>
                    <option value="2">Tháng 2</option>
                    <option value="3">Tháng 3</option>
                    <option value="4">Tháng 4</option>
                    <option value="5">Tháng 5</option>
                    <option value="6">Tháng 6</option>
                    <option value="7">Tháng 7</option>
                    <option value="8">Tháng 8</option>
                    <option value="9">Tháng 9</option>
                    <option value="10">Tháng 10</option>
                    <option value="11">Tháng 11</option>
                    <option value="12">Tháng 12</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-md-9">
            <div class="card card-success">
              <div class="card-header">
                <h3 class="card-title">Biểu đồ đơn hàng theo ngày tháng này</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                  </button>

                </div>
              </div>
              <div class="card-body">
                <!-- <div class="chart">
                  <canvas id="sales-chart-month" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                </div> -->
                <div class="row px-2">
                  <div class="col-12 col-sm-6 col-md-12">
                    <div class="row">
                      <div class="card-body col-6">
                        <h5>Dữ liệu tháng {{valueMonth}}</h5>
                          <div class="table-responsive">
                            <table border="1" class="table m-0 thead-dark w-100">
                              <thead class="thead-dark">
                                <tr>
                                  <th>Số đơn hàng đã bán</th>
                                  <th>Tổng tiền nhập</th>
                                  <th>Tổng tiền hàng</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr >
                                  <td class="align-middle"> {{turnOver?.billCount}} </td>
                                  <td class="align-middle"> {{turnOver?.importPrice.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                  <td class="align-middle"> {{turnOver?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                </tr>
                              </tbody>
                            </table>
                          <!-- /.table-responsive -->
                        </div>
                      </div>
                      <div class="card-body col-6">
                        <h5>Dữ liệu tháng trước</h5>
                          <div class="table-responsive">
                            <table border="1" class="table m-0 thead-info w-100">
                              <thead class="thead-light">
                                <tr>
                                  <th>Số đơn hàng đã bán</th>
                                  <th>Tổng tiền nhập</th>
                                  <th>Tổng tiền hàng</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr >
                                  <td class="align-middle"> {{turnOverLastMonth?.billCount}} </td>
                                  <td class="align-middle"> {{turnOverLastMonth?.importPrice.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                  <td class="align-middle"> {{turnOverLastMonth?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                </tr>
                              </tbody>
                            </table>
                          <!-- /.table-responsive -->
                        </div>
                      </div>
                    </div>


                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row px-2">
          <div class="col-12 col-sm-6 col-md-12">
            <div class="card card-success">
              <div class="card-header">
                <h3 class="card-title">Báo cáo doanh thu tháng {{valueMonth}}</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                  </button>

                </div>
              </div>
              <div class="card-body">
                <div class="row" id="report">
                  <div class="card-body d-flex align-items-center justify-content-center" style="padding-left: 20%;" >
                    <div class="col-12">
                      <div class="row">
                        <div class="col-4">
                          <span>Đơn vị: <strong>Nhị Quân Store</strong></span>
                        </div>
                        <div class="col-5 ">
                          <div class="col-9 text-center" style="float: right;">
                            <span class="text-center text-bold">Cộng Hòa Xã hội Chủ Nghĩa Việt Nam <br>
                              Độc lập - Tự do - Hạnh phúc
                            </span>
                          </div>

                        </div>
                      </div>
                      <div class="row">
                        <div class="col-8 text-center">
                          <h4>
                            BÁO CÁO DOANH THU THÁNG {{valueMonth}}
                          </h4>
                        </div>

                      </div>
                      <div class="row">
                        <div class="col-9">
                          <h5>
                            I. Hoạt động bán hàng Online
                          </h5>
                          <div>
                            <table class="table m-0 thead-info w-100">
                              <thead class="thead-light">
                                <tr>
                                  <th>Số đơn hàng đã bán</th>
                                  <th>Tổng tiền hàng</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr >
                                  <td class="align-middle"> {{turnOverOnline?.billCount}} </td>
                                  <td class="align-middle"> {{turnOverOnline?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-9">
                          <h5>
                            II. Hoạt động bán hàng tại quầy
                          </h5>
                          <div>
                            <table class="table m-0 thead-info w-100">
                              <thead class="thead-light">
                                <tr>
                                  <th>Số đơn hàng đã bán</th>
                                  <th>Tổng tiền hàng</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr >
                                  <td class="align-middle"> {{turnOverOffline?.billCount}} </td>
                                  <td class="align-middle"> {{turnOverOffline?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>

                      </div>
                      <div class="row">
                        <div class="col-9">
                          <h5>
                            III. Thu chi
                          </h5>
                          <div>
                            <table class="table m-0 thead-info w-100">
                              <thead class="thead-light">
                                <tr>
                                  <th>Tổng giá trị nhập hàng</th>
                                  <th>Tổng tiền hàng đã bán</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr >
                                  <td class="align-middle"> {{turnOver?.importPrice.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                  <td class="align-middle"> {{turnOver?.turnover.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}} </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-9">
                          <h5>
                            IV. Thống kê đơn hàng
                          </h5>
                          <div>
                            <table class="table m-0 thead-info w-100">
                              <thead class="thead-light">
                                <tr>
                                  <th>Đơn thành công</th>
                                  <th>Đơn đang xử lý</th>
                                  <th>Đơn thất bại</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr >
                                  <td class="align-middle"> {{turnOverOnline?.billCount + turnOverOffline?.billCount}} </td>
                                  <td class="align-middle"> {{turnOverAll?.billCount - (turnOverOnline?.billCount + turnOverOffline?.billCount) - turnOverCanceled?.billCount}} </td>
                                  <td class="align-middle"> {{turnOverCanceled?.billCount }} </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-9 ">
                          <div class="col-6 text-center" style="float: right;">
                            <span class="text-center text-bold">
                              Xác nhận của chủ shop
                              <p style="min-height: 70px;"></p>
                            </span>
                          </div>

                        </div>
                      </div>
                    </div>


                  </div>

                </div>
              </div>


          </div>
        </div>

      </div>
    </div>
  </div>
</div>


