
<div class="content-wrapper">
  <div class="container-fluid">
    <div class="content-body">
      <div class="row">
        <div class="col-12 m-b-30">
          <div class="d-flex justify-content-between mt-3">

          </div>
        </div>
        <!-- Pagination -->
      </div>
      <div class="row">
        <div class="col-12 m-b-30">
          <div class="card">
            <app-shopping-cart
            [shopping_Cart]="shoppingCart"
            [totalPrice]="totalPrice"
            [discount]="discount"
            [totalItem]="totalItem"
            [totalPay]="totalPay"
            (remove)="removeProduct($event)"
            (payment)="payment($event)"
            (onCheckPayment)="checkPayment()"
            (onUpdateQuantity) ="updateQuantityCart($event)"
            ></app-shopping-cart>
          </div>
        </div>

      </div>
      <!-- Tim kiem -->
      <div class="row m-2">
        <div class="card col-sm-12 p-0 collapsed-card">
          <div class="card-header bg-black">
            <h3 class="card-title"><strong>Bộ lọc tìm kiếm</strong></h3>

            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body">
              <div class="row">
                <div class="col-sm-3">
                  <div class="form-group">
                    <label for="inputEmail" class="">Tên sản phẩm</label>
                    <input type="text" class="form-control" id="inputEmail" name="code" [(ngModel)]="productName" placeholder="Nhập Tên sản phẩm">
                  </div>
                </div>
                <div class="col-sm-3">
                  <div class="form-group">
                    <label for="inputEmail" class="">Mã sản phẩm</label>
                    <input type="text" class="form-control" id="inputEmail" name="code" [(ngModel)]="productCode" placeholder="Nhập Mã sản phẩm">
                  </div>
                </div>
                  <div class="col-sm-3">
                    <div class="form-group">
                      <label for="category">Thể loại</label>
                          <select class=" select2bs4" id="category" name="categoryId" [(ngModel)]="categoryId" style="width: 100%;" required>
                            <option value="0" >Chọn</option>
                            <option *ngFor="let cat of categoryList" value="{{cat.id}}" >{{cat.name}}</option>
                          </select>
                    </div>
                  </div>
                  <div class="col-sm-3">
                    <div class="form-group">
                      <label for="production">Hãng</label>
                      <select class=" select2bs4" id="production" name="productionId" [(ngModel)]="productionId" style="width: 100%;" >
                        <option [value]="0" >Chọn</option>
                        <option class="option-value" *ngFor="let production of productionList" value="{{production.id}}">{{production.name}}</option>
                      </select>
                    </div>
                  </div>


                  <div class="row w-100 d-flex align-items-center justify-content-center ">
                    <div class="">
                      <button type="button" class="btn btn-primary" (click)="onSearch()">
                        <i class="fas fa-search"> </i>Tìm kiếm
                      </button>
                      &nbsp;
                      <button type="button" class="btn btn-danger" *ngIf="checkSearch===true" (click)="onAbortSearch()" >
                        <i class="fas fa-ban"></i> Hủy
                      </button>
                    </div>
                  </div>
              </div>
            </div>

        </div>
      </div>


      <!-- end tim kiem -->
      <div class="row product-table shadow">

        <div class="col-12 m-b-30">
          <table id="example1" class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width: 10px">#</th>
                <!-- <th>ID</th> -->
                <th></th>
                <th>Tên</th>
                <th>Code</th>
                <th>SL trong kho</th>
                <td></td>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of productList; index as i">
                <td class="align-middle">{{i + 1}}</td>
                <!-- <td><p class="font-weight-bold text-primary">{{item.id}}</p></td> -->
                <td class="align-middle"><img class="img-fluid card-img-top product-image" src="{{item.avatarUrl}}" alt="Card image cap"></td>
                <td class="align-middle" width="40%">
                  <a class="text-primary name" data-toggle="modal" data-target="#modal-xl" (click)="onGetProductDetails(item.id)">
                    {{item.name}}
                  </a>
                  <div>
                    <div class="d-flex sale" *ngIf="productList[i].saleEntity && productList[i].id == countDown[i].idPr">
                      <div class="sale-percent btn">SALE {{productList[i].saleEntity.sale}}% in
                       <span class="countdown">{{countDown[i].days}}</span>:<span class="countdown">{{countDown[i].hours}}</span>:<span class="countdown">{{countDown[i].minutes}}</span>:<span class="countdown">{{countDown[i].seconds}}</span>
                      </div>

                    </div>
                  </div>
                  <div class="bg-dark py-2 px-3 mt-4 price">
                    <h5 class="mb-0" *ngIf="item.saleEntity == null || item.saleEntity == 0">
                      {{item.salePrice.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                      <!-- {{product.salePrice}} -->
                    </h5>
                    <div *ngIf="item.saleEntity">
                      <h5 class="mb-0" >
                        {{(item.salePrice - item.salePrice * item.saleEntity.sale / 100).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                        <!-- {{product.salePrice}} -->
                      </h5>
                      <h5 class="mt-0">
                        <!-- <small>Ex Tax: ${{(product.salePrice * 1.2)}} </small> -->
                        <small>Ex Tax: <del>{{(item.salePrice).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}</del> </small>
                      </h5>
                    </div>

                  </div>
                </td>
                <td class="align-middle"><span class="font-weight-bold text-info">{{item.code}}</span></td>

                <td class="align-middle">{{item.quantity}}</td>
                <td class="align-middle">
                  <a class="btn mb-1 btn-success text-white mr-2" (click)="addShoppingCart(item.id)">Thêm vào giỏ hàng <i class="fas fa-shopping-cart"></i></a>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <th style="width: 10px">#</th>
                <!-- <th>ID</th> -->
                <th></th>
                <th>Tên</th>
                <th>Code</th>
                <th>SL trong kho</th>
                <td></td>
              </tr>
            </tfoot>
          </table>
        </div>

        <div class="col-lg-12" >
          <!-- <div class="modal fade" id="modal-xl" *ngIf="productDetails && onShow === true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title">Hóa đơn thanh toán</h4>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="onEndShowDetails()">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body" >

                </div>
                <div class="modal-footer justify-content-between">
                  <button type="button" class="btn btn-default" data-dismiss="modal" (click)="onEndShowDetails()">Close</button>
                </div>
              </div>
            </div>
          </div> -->

          <div class="modal fade" id="modal-xl" *ngIf="productDetails && onShow === true">
            <div class="modal-dialog modal-xl">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="onEndShowDetails()">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <!-- product details -->
                  <div class="">
                    <div class="">
                      <div class="row">

                        <h3 class="my-3">Mã sản phẩm: {{productDetails.code}}</h3>
                      </div>
                      <div class="row">
                        <div class="col-12 col-sm-6">

                          <h3 class="d-inline-block d-sm-none">{{productDetails.name}}</h3>
                          <div class="col-12">
                            <div class="d-flex sale" *ngIf="productDetails.saleEntity">
                              <!-- <div class="sale-percent btn text-right">SALE {{product.saleEntity.sale}}%
                                <br>  <p id="countdown">{{days}}:{{hours}}:{{minutes}}:{{seconds}}</p>
                              </div> -->
                              <div class="sale-details-percent btn">SALE {{productDetails.saleEntity.sale}}% in
                                <span class="countdown">{{days}}</span>:<span class="countdown">{{hours}}</span>:<span class="countdown">{{minutes}}</span>:<span class="countdown">{{seconds}}</span>
                               </div>

                            </div>

                            <!-- <img src="{{product.avatarUrl}}" class="product-image" alt="Product Image"> -->
                            <!-- exmple -->
                            <div class="bootstrap-carousel">
                              <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                                <div class="carousel-inner">
                                  <ol class="carousel-indicators">
                                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                                    <li data-target="#carouselExampleIndicators" *ngIf="productDetails.listImage.length >=1" data-slide-to="1"></li>
                                    <li data-target="#carouselExampleIndicators" *ngIf="productDetails.listImage.length >=2" data-slide-to="2"></li>
                                    <li data-target="#carouselExampleIndicators" *ngIf="productDetails.listImage.length >=3" data-slide-to="3"></li>
                                    <li data-target="#carouselExampleIndicators" *ngIf="productDetails.listImage.length >=4" data-slide-to="4"></li>
                                    <li data-target="#carouselExampleIndicators" *ngIf="productDetails.listImage.length >=5" data-slide-to="5"></li>
                                </ol>
                                    <div class="carousel-item active">
                                        <img class="d-block w-100 product-details-image " src="{{productDetails.avatarUrl}}" alt="First slide">
                                    </div>
                                    <div class="carousel-item" *ngFor="let item of productDetails.listImage; index as i">
                                        <img class="d-block w-100 product-details-image" src="{{item.imageUrl}}" alt="{{i}} slide">
                                    </div>
                                    <!-- <div class="carousel-item">
                                        <img class="d-block w-100 product-image" src="" alt="Third slide">
                                    </div>
                                    <div class="carousel-item">
                                      <img class="d-block w-100 product-image" src="" alt="Third slide">
                                    </div> -->
                                  <a class="carousel-control-prev" href="#carouselExampleIndicators" data-slide="prev"><span class="carousel-control-prev-icon"></span> <span class="sr-only">Previous</span> </a><a class="carousel-control-next" href="#carouselExampleIndicators"
                                  data-slide="next"><span class="carousel-control-next-icon"></span> <span class="sr-only">Next</span></a>

                                </div>
                            </div>
                            </div>
                            <!-- end example -->
                          </div>
                          <div class="col-12 product-image-thumbs" >
                            <div class="product-image-thumb" *ngFor="let item of productDetails.listImage"><img src="{{item.imageUrl}}" alt="Product Image"></div>
                          </div>

                        </div>
                        <div class="col-12 col-sm-6">

                          <h3 class="my-3">{{productDetails.name}}</h3>
                          <p class="card-text">
                            <small class="text-muted">Created by: {{productDetails.createdByName}}</small> <br>
                            <small class="text-muted">Last updated {{productDetails.modifiedDate | date :'short'}} By: {{productDetails.modifiedByName}}</small>
                          </p>

                          <hr>

                          <h4>Thuộc tính sản phẩm</h4>
                          <div class="btn-group btn-group-toggle w-100"  data-toggle="buttons">
                            <table class="table" width="100%">
                              <thead class="thead-dark">
                                <tr>
                                  <th>Thuộc tính</th>
                                  <th>Nội dung</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let item of productDetails.listInformation">
                                  <td>{{item.key}}</td>
                                  <td>{{item.value}}</td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                          <h4><small>Số lượng trong kho: </small> {{productDetails.quantity}}</h4>
                          <div class="bg-dark py-2 px-3 mt-4">
                            <h2 class="mb-0" *ngIf="productDetails.saleEntity == null || productDetails.saleEntity == 0">
                              {{productDetails.salePrice.toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                              <!-- {{product.salePrice}} -->
                            </h2>
                            <div *ngIf="productDetails.saleEntity">
                              <h2 class="mb-0" >
                                {{(productDetails.salePrice - productDetails.salePrice * productDetails.saleEntity.sale / 100).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}
                                <!-- {{product.salePrice}} -->
                              </h2>
                              <h4 class="mt-0">
                                <!-- <small>Ex Tax: ${{(product.salePrice * 1.2)}} </small> -->
                                <small>Ex Tax: $<del>{{(productDetails.salePrice).toLocaleString('it-IT', {style : 'currency', currency : 'VND'})}}</del> </small>
                              </h4>
                            </div>

                          </div>

                          <!-- <div class="mt-4">
                            <div class="btn btn-primary btn-lg btn-flat">
                              <i class="fas fa-cart-plus fa-lg mr-2"></i>
                              Add to Cart
                            </div>

                            <div class="btn btn-default btn-lg btn-flat">
                              <i class="fas fa-heart fa-lg mr-2"></i>
                              Add to Wishlist
                            </div>
                          </div> -->


                        </div>
                      </div>
                      <div class="row mt-4">
                        <nav class="w-100">
                          <div class="nav nav-tabs" id="product-tab" role="tablist">
                            <a class="nav-item nav-link active" id="product-desc-tab" data-toggle="tab" href="#product-desc" role="tab" aria-controls="product-desc" aria-selected="true">Description</a>
                          </div>
                        </nav>
                        <div class="tab-content p-3" id="nav-tabContent">
                          <!-- <div class="tab-pane fade show active" id="product-desc" role="tabpanel" aria-labelledby="product-desc-tab"
                          [innerHTML]="product.description"
                          >

                          </div> -->
                          <div class="textarea inline-editor" name="description" id="textareaInput">

                                        </div>
                        </div>
                      </div>
                    </div>
                    <!-- /.card-body -->
                  </div>
                  <!-- end product details -->
                </div>
                <div class="modal-footer justify-content-between">
                  <button type="button" class="btn btn-default" data-dismiss="modal" (click)="onEndShowDetails()">Close</button>
                </div>
              </div>
              <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
          </div>
        </div>



      </div>
    </div>
  </div>
</div>


